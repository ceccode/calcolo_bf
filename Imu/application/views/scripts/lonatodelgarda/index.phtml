<div id="contenitore-index">
<h2>Calcolo web imu. Passo1:</h2>
<small style="font-weight: bold;">compila i campi sottostanti e premi il pulsante: "continua il calcolo".</small>
<?
    $this->headTitle("Calcolo imu lonato");
    echo $this->form;
?>
</div>
<script type="text/javascript">
$(function()
{
    $("#capacita_edificatoria").blur(function(){
        //alert($(this).parent().prev().find('label').attr('for'));
        var id = $(this);
        if(id.val()==''){
           $("#submit").attr("disabled", "true");
        }else {
           $("#submit").removeAttr("disabled");
        }
        
        doValidation(id);
               
        });
      

    function doValidation(id){
        var url = '/public/Lonatodelgarda/validate-form';
        var data = {};
        data[id.attr('name')] = id.val();

        $.post(url,data,function(resp){

            var id2 = id.attr('name');
            $("#"+id2).parent().find("ul").remove();            
            $("#"+id2).after(getErrorHtml(resp[id2],id2));
            //getErrorHtml(resp[id2]),id2
            
        },'json');
    }

    function getErrorHtml(formsError, id){
        var o = '<ul id="errors-'+id+'" class="errors">';
        for(errorKeys in formsError)
        {
            o += '<li>'+formsError[errorKeys]+'</li>';
        }
        o += '</ul>';
        return o;
    }
    
    
});
</script>

